# è¿åŠ¨æ­å­App - Cloudbaseåç«¯

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

è¿åŠ¨æ­å­Appæ˜¯ä¸€ä¸ªåŸºäºè…¾è®¯äº‘å¼€å‘(Cloudbase)çš„è¿åŠ¨ç¤¾äº¤åº”ç”¨åç«¯æœåŠ¡ï¼Œæä¾›ç±»ä¼¼å°çº¢ä¹¦çš„è¿åŠ¨å†…å®¹åˆ†äº«å’Œç¤¾äº¤äº’åŠ¨ä½“éªŒã€‚æ”¯æŒAndroidå’ŒiOSç§»åŠ¨åº”ç”¨ã€‚

## ğŸš€ æŠ€æœ¯æ ˆ

- **äº‘å¼€å‘å¹³å°**: è…¾è®¯äº‘å¼€å‘ (Cloudbase)
- **è¿è¡Œæ—¶**: Node.js 16+
- **æ•°æ®åº“**: äº‘æ•°æ®åº“ (MongoDBæ–‡æ¡£å‹)
- **å­˜å‚¨**: äº‘å­˜å‚¨ (å›¾ç‰‡/è§†é¢‘æ–‡ä»¶)
- **è®¤è¯**: è‡ªå®šä¹‰ç™»å½• (æ‰‹æœºå·éªŒè¯ç /ç¬¬ä¸‰æ–¹ç™»å½•)
- **äº‘å‡½æ•°**: Serverlessæ¶æ„
- **å®¢æˆ·ç«¯**: Android/iOS App (React Native/Flutter/åŸç”Ÿ)

## ğŸ“ é¡¹ç›®ç»“æ„

```
yundong-backend/
â”œâ”€â”€ cloudfunctions/          # äº‘å‡½æ•°ç›®å½•
â”‚   â”œâ”€â”€ user-login/         # ç”¨æˆ·ç™»å½•/æ³¨å†Œ
â”‚   â”œâ”€â”€ user-profile/       # ç”¨æˆ·ä¿¡æ¯ç®¡ç†
â”‚   â”œâ”€â”€ user-follow/        # å…³æ³¨ç³»ç»Ÿ
â”‚   â”œâ”€â”€ posts/              # åŠ¨æ€å‘å¸ƒå’Œç®¡ç†
â”‚   â”œâ”€â”€ messages/           # æ¶ˆæ¯é€šçŸ¥
â”‚   â”œâ”€â”€ search/             # æœç´¢åŠŸèƒ½
â”‚   â”œâ”€â”€ collections/        # æ”¶è—åŠŸèƒ½
â”‚   â”œâ”€â”€ activities/         # æ´»åŠ¨ç®¡ç†
â”‚   â””â”€â”€ package.json        # äº‘å‡½æ•°ä¾èµ–
â”œâ”€â”€ database/               # æ•°æ®åº“ç›¸å…³
â”‚   â””â”€â”€ init.sql           # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ docs/                   # æ–‡æ¡£ç›®å½•
â”‚   â””â”€â”€ api-examples.md    # APIä½¿ç”¨ç¤ºä¾‹
â”œâ”€â”€ cloudbaserc.json        # CloudBase CLIé…ç½®
â”œâ”€â”€ DEPLOYMENT.md           # è¯¦ç»†éƒ¨ç½²æŒ‡å—
â”œâ”€â”€ PROGRESS.md             # å¼€å‘è¿›åº¦
â””â”€â”€ README.md              # é¡¹ç›®æ–‡æ¡£
```

## ğŸ—ï¸ æ ¸å¿ƒåŠŸèƒ½

### ç¬¬ä¸€é˜¶æ®µ - æ ¸å¿ƒåŠŸèƒ½ âœ…
- [x] ç”¨æˆ·è®¤è¯ç™»å½•ç³»ç»Ÿ (æ‰‹æœºå·éªŒè¯ç ã€ç¬¬ä¸‰æ–¹ç™»å½•)
- [x] ç”¨æˆ·ä¿¡æ¯ç®¡ç† (èµ„æ–™ç¼–è¾‘ã€å¤´åƒä¸Šä¼ )
- [x] åŠ¨æ€å‘å¸ƒå’Œæµè§ˆ (å›¾ç‰‡/è§†é¢‘åŠ¨æ€)
- [x] åŸºç¡€äº’åŠ¨åŠŸèƒ½ (ç‚¹èµã€è¯„è®º)
- [x] å…³æ³¨ç³»ç»Ÿ (å…³æ³¨ã€å–æ¶ˆå…³æ³¨)
- [x] æ¶ˆæ¯é€šçŸ¥ (ç‚¹èµã€è¯„è®ºã€å…³æ³¨é€šçŸ¥)

### ç¬¬äºŒé˜¶æ®µ - ç¤¾äº¤åŠŸèƒ½ âœ…
- [x] æœç´¢åŠŸèƒ½ (ç”¨æˆ·ã€åŠ¨æ€ã€æ´»åŠ¨ã€è¯é¢˜æœç´¢)
- [x] è¯é¢˜ç³»ç»Ÿ (æ ‡ç­¾ç®¡ç†)
- [x] æ”¶è—åŠŸèƒ½
- [x] æœç´¢å†å²å’Œå»ºè®®

### ç¬¬ä¸‰é˜¶æ®µ - æ´»åŠ¨åŠŸèƒ½ âœ…
- [x] æ´»åŠ¨åˆ›å»ºå’Œç®¡ç†
- [x] æ´»åŠ¨å‚ä¸ç³»ç»Ÿ
- [x] åœ°ç†ä½ç½®æœåŠ¡
- [x] æ¨èç®—æ³•

### ç¬¬å››é˜¶æ®µ - é«˜çº§åŠŸèƒ½ ğŸ”®
- [ ] å®æ—¶èŠå¤©
- [ ] æ•°æ®ç»Ÿè®¡åˆ†æ
- [ ] å†…å®¹å®¡æ ¸
- [ ] è¿è¥ç®¡ç†åå°

## ğŸ› ï¸ å®‰è£…éƒ¨ç½²

### 1. ç¯å¢ƒå‡†å¤‡

1. å®‰è£… [CloudBase CLI](https://docs.cloudbase.net/cli-v1/install.html)
2. è´­ä¹°å¹¶å¼€é€šè…¾è®¯äº‘CloudBaseç¯å¢ƒ
3. è·å–CloudBaseç¯å¢ƒID

### 2. é¡¹ç›®é…ç½®

1. å…‹éš†é¡¹ç›®åˆ°æœ¬åœ°
2. å®‰è£…CloudBase CLI: `npm install -g @cloudbase/cli`
3. ç™»å½•CloudBase: `cloudbase login`
4. ä¿®æ”¹ `cloudbaserc.json` ä¸­çš„ç¯å¢ƒID

### 3. æ•°æ®åº“åˆå§‹åŒ–

1. ç™»å½•è…¾è®¯äº‘CloudBaseæ§åˆ¶å°
2. è¿›å…¥æ•°æ®åº“ç®¡ç†é¡µé¢
3. æŒ‰ç…§ `database/init.sql` åˆ›å»ºé›†åˆå’Œç´¢å¼•

### 4. äº‘å‡½æ•°éƒ¨ç½²

ä½¿ç”¨CloudBase CLIéƒ¨ç½²äº‘å‡½æ•°ï¼š

```bash
# éƒ¨ç½²æ‰€æœ‰äº‘å‡½æ•°
cloudbase functions:deploy

# æˆ–å•ç‹¬éƒ¨ç½²
cloudbase functions:deploy user-login
cloudbase functions:deploy user-profile
cloudbase functions:deploy user-follow
cloudbase functions:deploy posts
cloudbase functions:deploy messages
cloudbase functions:deploy search
cloudbase functions:deploy collections
cloudbase functions:deploy activities
```

## ğŸ“– è¯¦ç»†æ–‡æ¡£

- ğŸ“˜ **[å®Œæ•´éƒ¨ç½²æŒ‡å—](./DEPLOYMENT.md)** - Android/iOSåº”ç”¨CloudBaseéƒ¨ç½²è¯¦ç»†æ­¥éª¤
- ğŸ“— **[APIä½¿ç”¨ç¤ºä¾‹](./docs/api-examples.md)** - è¯¦ç»†çš„æ¥å£è°ƒç”¨ç¤ºä¾‹
- ğŸ“™ **[å¼€å‘è¿›åº¦æŠ¥å‘Š](./PROGRESS.md)** - é¡¹ç›®åŠŸèƒ½å®Œæˆæƒ…å†µå’ŒæŠ€æœ¯æ¶æ„

## ğŸ“š APIæ–‡æ¡£

### ç»Ÿä¸€å“åº”æ ¼å¼

```javascript
// æˆåŠŸå“åº”
{
  code: 0,
  message: "success",
  data: {}, // å…·ä½“æ•°æ®
  timestamp: 1642867200000
}

// é”™è¯¯å“åº”
{
  code: 4001, // é”™è¯¯ç 
  message: "å‚æ•°é”™è¯¯", // é”™è¯¯ä¿¡æ¯
  data: null,
  timestamp: 1642867200000
}
```

### é”™è¯¯ç è¯´æ˜

- `0`: æˆåŠŸ
- `4001`: å‚æ•°é”™è¯¯
- `4002`: ä¸šåŠ¡é€»è¾‘é”™è¯¯
- `4003`: æƒé™é”™è¯¯
- `4004`: èµ„æºä¸å­˜åœ¨
- `5001`: æœåŠ¡å™¨å†…éƒ¨é”™è¯¯

### ä¸»è¦APIæ¥å£

#### ç”¨æˆ·ç™»å½• (user-login)

```javascript
// å¾®ä¿¡æˆæƒç™»å½•
wx.cloud.callFunction({
  name: 'user-login',
  data: {
    action: 'wechat_login',
    data: {
      userInfo: userInfo // å¾®ä¿¡ç”¨æˆ·ä¿¡æ¯
    }
  }
})

// æ‰‹æœºå·ç™»å½•
wx.cloud.callFunction({
  name: 'user-login',
  data: {
    action: 'phone_login',
    data: {
      phone: '13800138000',
      code: '123456'
    }
  }
})
```

#### ç”¨æˆ·ä¿¡æ¯ (user-profile)

```javascript
// è·å–ç”¨æˆ·èµ„æ–™
wx.cloud.callFunction({
  name: 'user-profile',
  data: {
    action: 'get_profile'
  }
})

// æ›´æ–°ç”¨æˆ·èµ„æ–™
wx.cloud.callFunction({
  name: 'user-profile',
  data: {
    action: 'update_profile',
    data: {
      nickname: 'æ–°æ˜µç§°',
      bio: 'ä¸ªäººç®€ä»‹'
    }
  }
})
```

#### åŠ¨æ€ç®¡ç† (posts)

```javascript
// å‘å¸ƒåŠ¨æ€
wx.cloud.callFunction({
  name: 'posts',
  data: {
    action: 'create',
    data: {
      type: 'image',
      content: 'ä»Šå¤©è·‘æ­¥10å…¬é‡Œ #è·‘æ­¥# #è¿åŠ¨æ­å­#',
      images: ['cloud://xxx.jpg']
    }
  }
})

// è·å–åŠ¨æ€åˆ—è¡¨
wx.cloud.callFunction({
  name: 'posts',
  data: {
    action: 'list',
    data: {
      type: 'recommend', // recommend/following
      page: 1,
      pageSize: 20
    }
  }
})
```

## ğŸ—„ï¸ æ•°æ®åº“è®¾è®¡

### ä¸»è¦é›†åˆ

1. **users** - ç”¨æˆ·è¡¨
2. **posts** - åŠ¨æ€è¡¨  
3. **activities** - æ´»åŠ¨è¡¨
4. **follows** - å…³æ³¨å…³ç³»è¡¨
5. **likes** - ç‚¹èµè¡¨
6. **comments** - è¯„è®ºè¡¨
7. **messages** - æ¶ˆæ¯è¡¨
8. **search_history** - æœç´¢å†å²è¡¨
9. **collections** - æ”¶è—è¡¨

è¯¦ç»†å­—æ®µè¯´æ˜è¯·å‚è€ƒé¡¹ç›®å¼€å¤´çš„æŠ€æœ¯è§„èŒƒæ–‡æ¡£ã€‚

## ğŸ”’ å®‰å…¨æœºåˆ¶

- æ‰€æœ‰äº‘å‡½æ•°éƒ½è¿›è¡Œèº«ä»½éªŒè¯
- æ•æ„Ÿæ“ä½œéœ€è¦é¢å¤–æƒé™æ ¡éªŒ
- è¾“å…¥å‚æ•°ä¸¥æ ¼éªŒè¯
- é˜²SQLæ³¨å…¥å’ŒXSSæ”»å‡»
- APIè°ƒç”¨é¢‘ç‡é™åˆ¶

## ğŸš€ æ€§èƒ½ä¼˜åŒ–

- æ•°æ®åº“æŸ¥è¯¢ä½¿ç”¨ç´¢å¼•
- å¤§åˆ—è¡¨åˆ†é¡µåŠ è½½
- å›¾ç‰‡/è§†é¢‘CDNåŠ é€Ÿ
- çƒ­ç‚¹æ•°æ®ç¼“å­˜
- äº‘å‡½æ•°å†·å¯åŠ¨ä¼˜åŒ–

## ğŸ“ˆ ç›‘æ§è¿ç»´

- äº‘å‡½æ•°æ‰§è¡Œæ—¥å¿—
- æ•°æ®åº“æ€§èƒ½ç›‘æ§
- é”™è¯¯å‘Šè­¦æœºåˆ¶
- èµ„æºä½¿ç”¨ç»Ÿè®¡

## ğŸ¤ å¼€å‘è§„èŒƒ

### ä»£ç é£æ ¼
- ä½¿ç”¨ES6+è¯­æ³•
- éµå¾ªAirbnb JavaScriptè§„èŒƒ
- æ¯ä¸ªå‡½æ•°éƒ½è¦æœ‰è¯¦ç»†æ³¨é‡Š
- å®Œå–„çš„é”™è¯¯å¤„ç†

### Gitæäº¤è§„èŒƒ
- feat: æ–°åŠŸèƒ½
- fix: ä¿®å¤bug
- docs: æ–‡æ¡£æ›´æ–°
- style: ä»£ç æ ¼å¼è°ƒæ•´
- refactor: ä»£ç é‡æ„
- test: æµ‹è¯•ç›¸å…³
- chore: å…¶ä»–ä¿®æ”¹

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·è”ç³»å¼€å‘å›¢é˜Ÿã€‚

## ï¿½ï¿½ è®¸å¯è¯

MIT License 